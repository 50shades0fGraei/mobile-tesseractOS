
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Codemap | Tesseract OS</title>
    <link rel="stylesheet" href="https://unpkg.com/xterm@5.3.0/css/xterm.css" />
    <style>
      body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: #1E1E1E;
      }
      #terminal-container {
        width: 100%;
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <div id="terminal-container"></div>

    <!-- Load the libraries -->
    <script src="https://unpkg.com/xterm@5.3.0/lib/xterm.js"></script>
    <!-- The Socket.IO client is served automatically by the Flask-SocketIO server -->
    <script src="/socket.io/socket.io.js"></script>

    <script>
      // 1. Create and configure the terminal
      const term = new Terminal({
        cursorBlink: true,
        fontFamily: '"Cascadia Code", Menlo, monospace',
        fontSize: 14,
        theme: {
          background: '#1E1E1E',
          foreground: '#E0E0E0',
          cursor: '#E0E0E0',
        }
      });
      term.open(document.getElementById('terminal-container'));

      // 2. Establish a WebSocket connection
      // The server will be at the same host and port
      const socket = io();

      // 3. Set up two-way communication

      // Send terminal input to the server
      term.onData(data => {
        socket.emit('pty-input', { 'input': data });
      });

      // Receive terminal output from the server
      socket.on('pty-output', data => {
        term.write(data.output);
      });

      // Handle connection events
      socket.on('connect', () => {
        term.write('\r\n[Connected to Tesseract OS]\r\n');
      });

      socket.on('disconnect', () => {
        term.write('\r\n[Disconnected]\r\n');
      });

    </script>
  </body>
</html>
